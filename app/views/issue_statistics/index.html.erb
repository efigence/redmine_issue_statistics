<%= render :partial => 'issue_statistics/links' %>
<% if @issue_statistics.empty? %>
  <p class="nodata"><%= l(:label_no_data) %></p>
<% else %>
<% @periods.each do |period| %>
<h3><%= l(period.to_sym) %></h3>
<table class="list issues">
 <%= render :partial => 'issue_statistics/thead' %>
  <tbody>
    <% @issue_statistics.where(period: period).each do |stat| %> 
      <tr>
        <td><%= stat.id %></td>
        <td><%= stat.statisticable_type %></td>
        <% if stat.statisticable_type == "User" %>
          <td><%= link_to "#{User.find(stat.statisticable_id).name}", users_path %> </td>
        <% else %>
          <td><%= link_to "#{Project.find(stat.statisticable_id).name}", projects_path %> </td>
        <% end %>
        <td><%= stat.total %></td>
        <td><%= stat.opened %></td>
        <td><%= stat.closed %></td>
        <td><%= progress_bar(stat.opened_to_closed.round(2),:width => '80px', :class => 'progress', :legend => "#{stat.opened_to_closed.round(2)}%") %></td>
        <td><%= link_to "#{stat.returned}" %></td>
        <td><%= stat.comment_max %></td>
        <td><%= stat.avg_issue_time.round(2) %> h</td>
        <% end %>
      </tr>
    </tbody>
  </table>
  <% end %>
  <hr />
<% end %> 

<% content_for :header_tags do %>
    <%= javascript_include_tag 'highcharts', :plugin => 'redmine_issue_statistics' %>
<% end %>