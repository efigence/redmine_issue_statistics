<script type="text/javascript" charset="utf-8">
  $(function () {
    var chart;
    chart = new Highcharts.Chart({
      chart: { renderTo: '<%= id_statisticable %><%= period %>',
               type: 'column',
                plotBackgroundColor: null,
                plotBorderWidth: null,
                plotShadow: false
      },
      title: { text: ''  },
      xAxis: {
        categories: [<%= raw period.to_json %>]
      },
      yAxis: {
        title: { text: '' },
        stackLabels: {
          style: {
              color: 'black'
          },
          enabled: true
      }
      },
      credits: {
        text: ''
      },
      tooltip: {
          formatter: function() {
                      return this.series.name + ' : ' + this.y ;
                    }
      },
      plotOptions: {
            column: {
              pointPadding: 0,
              groupPadding: 0,
              dataLabels: {
                enabled: true,
                align: 'center',
                crop: false,
                overflow:"none",
                color: "#707070"
              }
            },
            series: {
              showInLegend: false,
              cursor: 'pointer',
              point: {
                  events: {
                      click: function (event) {
                          window.location.href = event.point.url + '<%= relate_id && "?relate_id=#{relate_id}" %>';
                      }
                  }
              }
            }
      },
      series: [{
        name: '<%=l(:field_total)%>',
        data: [{
                y: <%= raw str[:total][pidx].to_json  %>,
                url: '<%= home_url %>/issue_statistics/total_issues/<%= id_statisticable %>/<%= type_statisticable %>/'+ <%= raw period.to_json %>
              }]
              },
      {
        name: '<%=l(:field_opened)%>',
        data: [{
                y: <%= raw str[:opened][pidx].to_json  %>,
                url: '<%= home_url %>/issue_statistics/opened_issues/<%= id_statisticable %>/<%= type_statisticable %>/'+ <%= raw period.to_json %>
              }]
      },
      {
        name: '<%=l(:field_closed)%>',
        data: [{
                y: <%= raw str[:closed][pidx].to_json  %>,
                url: '<%= home_url %>/issue_statistics/closed_issues/<%= id_statisticable %>/<%= type_statisticable %>/'+ <%= raw period.to_json %>
              }]
      },
      {
        name: '<%=l(:field_returned)%>',  
        data: [{
                y: <%= raw str[:returned][pidx].to_json  %>,
                url: '<%= home_url %>/issue_statistics/returned_issues/<%= id_statisticable %>/<%= type_statisticable %>/'+ <%= raw period.to_json %>
              }]
      },
      {
        name: '<%= l(:field_comment_max) %>',
        data: [{
                y: <%= raw str[:comment_max][pidx].to_json  %>,
                url: '<%= home_url %>/issue_statistics/most_commented_issues/<%= id_statisticable %>/<%= type_statisticable %>/'+ <%= raw period.to_json %>
              }]
      },
      {
        name: '<%= l(:field_old_issues) %>',
        data: [{
                y: <%= raw str[:old_issues][pidx].to_json  %>,
                url: '<%= home_url %>/issue_statistics/older_issues/<%= id_statisticable %>/<%= type_statisticable %>/' + <%= raw period.to_json %>
              }]
      }
      ]
    });
  });
</script>